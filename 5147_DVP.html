<!DOCTYPE HTML>
<html lang="en">

<head>
    <meta charset='utf-8' />
    <!-- Load required scripts -->
    <script src="https://d3js.org/d3.v4.js"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
    <script src="https://d3js.org/d3-geo-projection.v2.min.js"></script>

    <link rel="stylesheet" href="Home.css">
</head>


<body>
    <div class="wrapper">
        <div class="typing-demo">
            Is Covid just a flu? If not, will it be?
        </div>
    </div>

    <div class="intro">
        <h1 class="intro_h1">The year of 2019 has been a lifechanging year
        </h1>

        <div class="paragraph-container">
            <p class="intro_p">
                And it will surely occupy at least a page in future
                literatures. The debuting of COVID has brought significant impacts to the world, though, some may see it
                as a marvellous opportunity while some may see it as a catastrophe. The attitude of a sovereign, or even
                a nation, determine its behavioural decisions as well as its countermeasure towards COVID to a great
                extent. Speaking of national level of point of view, each nation’s strategies in manging the pandemic
                largely varied. In essence, it is a dilemma of putting either the economy or social stability as the top
                priority at that one specific timeframe. “It’s just a flu” has been a famous quote of former president
                of the U.S. – Donald Trump during the initial stage of the pandemic. This data exploration study
                attempts to examine such statement, to see whether it was just a soothing statement or in fact, it was a
                scientific conclusion.
            </p>
        </div>
    </div>


    <div class="container">
        <div class="box">
            <p class="test">Global Death Toll of Covid-19 has Exceeded 6 million</p>
        </div>
    </div>

    <!-- Reference: https://d3-graph-gallery.com/graph/choropleth_hover_effect.html -->
    <!-- <div class="first"> -->
    <!-- Create an element where the map will take place -->
    <!-- <svg id="my_dataviz" width="600" height="500"></svg>
        <script>

            // The svg
            var svg = d3.select("svg"),
                width = +svg.attr("width"),
                height = +svg.attr("height");

            // Map and projection
            var path = d3.geoPath();
            var projection = d3.geoMercator()
                .scale(70)
                .center([0, 20])
                .translate([width / 2, height / 2]);

            // Data and color scale
            var data = d3.map();
            var colorScale = d3.scaleThreshold()
                .domain([100000, 1000000, 10000000, 30000000, 100000000, 500000000])
                .range(d3.schemeBlues[7]);

            // Load external data and boot
            d3.queue()
                .defer(d3.json, "https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world.geojson")
                .defer(d3.csv, "https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world_population.csv", function (d) { data.set(d.code, +d.pop); })
                .await(ready);

            function ready(error, topo) {

                let mouseOver = function (d) {
                    d3.selectAll(".Country")
                        .transition()
                        .duration(200)
                        .style("opacity", .5)
                    d3.select(this)
                        .transition()
                        .duration(200)
                        .style("opacity", 1)
                        .style("stroke", "black")
                }

                let mouseLeave = function (d) {
                    d3.selectAll(".Country")
                        .transition()
                        .duration(200)
                        .style("opacity", .8)
                    d3.select(this)
                        .transition()
                        .duration(200)
                        .style("stroke", "transparent")
                }

                // Draw the map
                svg.append("g")
                    .selectAll("path")
                    .data(topo.features)
                    .enter()
                    .append("path")
                    // draw each country
                    .attr("d", d3.geoPath()
                        .projection(projection)
                    )
                    // set the color of each country
                    .attr("fill", function (d) {
                        d.total = data.get(d.id) || 0;
                        return colorScale(d.total);
                    })
                    .style("stroke", "transparent")
                    .attr("class", function (d) { return "Country" })
                    .style("opacity", .8)
                    .on("mouseover", mouseOver)
                    .on("mouseleave", mouseLeave)
            }

        </script>
    </div> -->


    <div class="CFR">
        <h1 class="CFR_h1">Case Fatality Rate Comparison between 2009 Pandemic & COVID-19</h1>
        <p class="CFR_p">Fatality can be simply referred to the death rate per 100 cases of an infectious disease. When
            performing statistical analysis of fatality, there have been three mainstream approaches including Case
            Fatality Rate (CFR), Infectious Fatality Rate (IFR) and Crude Mortality Rate. CFR has been a popular
            approach and often cited by media when risk of death of COVID-19 is discussed; It is calculated through
            “number of death / total of diagnosed cases * 100“ while IFR is calculated as “number of death / total
            number of infected * 100”. Ideally, IFR seems to be the best approach to answer the question of “how deadly
            the disease is ?”, however, total number of infected is often not known especially for COVID-19 as there are
            many people who were symptomless and thus had not been diagnosed as a case. Therefore, CFR becomes a
            reasonable choice for media as well as the current study in comparing the fatality rate of the diseases.</p>

        <div class="CFR_vis">
            <div class="CFR_div">
                <svg id="triangle" viewBox="0 0 100 100">
                    <polygon id="tri1" class="tri1" points="50 15, 100 100, 0 100" fill="#d52105b4" />
                    <text x="50" y="12" text-anchor="middle" fill="white" font-size="5">2009 Flu (H1N1) </text>
                    <text id="tooltip1" class="tooltip" x="70" y="38" display="none" font-size="5">0.021</text>
                </svg>
            </div>
            <div class="CFR_div2">
                <svg id="triangle2" viewBox="0 0 100 100">
                    <polygon id="tri2" class="tri2" points="50 15, 100 100, 0 100" fill="#357EC7" />
                    <text x="50" y="6" text-anchor="middle" fill="white" font-size="9">Seasonal Flu </text>
                    <text id="tooltip2" class="tooltip" x="70" y="38" display="none" font-size="10">0.0046</text>
                </svg>
            </div>
            <div class="CFR_div3">
                <svg id="triangle3" viewBox="0 0 100 100">
                    <polygon id="tri3" class="tri3" points="50 15, 100 100, 0 100" fill="#6495ED" />
                    <text x="50" y="6" text-anchor="middle" fill="white" font-size="9">COVID-19 </text>
                    <text id="tooltip3" class="tooltip" x="70" y="38" display="none" font-size="10">0.0051</text>
                </svg>
            </div>
        </div>
    </div>

    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <!-- Reference: https://d3-graph-gallery.com/graph/barplot_button_data_csv.html -->

    <div class="barchart1">
        <h1 class="CFR_h1">Estimated Seasonal Flu Burden in U.S. (2010-2020)</h1>
        <p class="CFR_p">seasonal flu, as the extension of H1N1 - 2009 pandemic, appeared to share high similarities
            with COVID-19 in terms of fatality rate (deadliness). Therefore, the estimated burden of seasonal flu
            adapted from U.S. CDC (2022) was examined and provided as the following visualization.</p>
        <button class="bar_vis_1" onclick="update('Symptomatic')">Symptomatic</button>
        <button class="bar_vis_1" onclick="update('Medical_Visit')">Medical Visit</button>
        <button class="bar_vis_1" onclick="update('Hospitalization')">Hospitalisation</button>

        <!-- Reserve a div to contain the barchart -->
        <div id="my_dataviz" class="my_dataviz1"></div>
        <!-- <div id="tooltip-container">
            <p id="tooltip-text">Tooltip text goes here.</p>
        </div> -->
    </div>



</body>

<script>
    //Fetch all tooltips
    var tooltip1 = document.getElementById('tooltip1');
    var tooltip2 = document.getElementById('tooltip2');
    var tooltip3 = document.getElementById('tooltip3');

    //Display Tooltip
    function showTooltip(evt) {
        if (evt.path[0] == tri1) {
            tooltip1.setAttributeNS(null, "display", "block");
        }
        else if (evt.path[0] == tri2) {
            tooltip2.setAttributeNS(null, "display", "block");
        }
        else {
            tooltip3.setAttributeNS(null, "display", "block");
        }
        console.log(evt)
    }

    //Hide Tooltip
    function hideTooltip() {
        tooltip1.setAttributeNS(null, "display", "none");
        tooltip2.setAttributeNS(null, "display", "none");
        tooltip3.setAttributeNS(null, "display", "none");
    }

    //Fetch all triangles
    var tri1 = document.getElementById("tri1");
    var tri2 = document.getElementById("tri2");
    var tri3 = document.getElementById("tri3");


    //Attach eventlistener to each
    tri1.addEventListener('mousemove', showTooltip);
    tri1.addEventListener('mouseout', hideTooltip);
    tri2.addEventListener('mousemove', showTooltip);
    tri2.addEventListener('mouseout', hideTooltip);
    tri3.addEventListener('mousemove', showTooltip);
    tri3.addEventListener('mouseout', hideTooltip);




    //Bar Chart
    // set the dimensions and margins of the graph
    var margin = { top: 30, right: 30, bottom: 70, left: 60 },
        width = 920 - margin.left - margin.right,
        height = 600 - margin.top - margin.bottom;

    // append the svg object to the body of the page
    var svg = d3.select("#my_dataviz")
        .append("svg")
        .attr("width", 1000 + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
        .append("g")
        .attr("transform",
            "translate(" + margin.left + "," + margin.top + ")");

    // Initialize the X axis
    var x = d3.scaleBand()
        .range([0, width])
        .padding(0.2);
    var xAxis = svg.append("g")
        .attr("transform", "translate(0," + height + ")")

    // Initialize the Y axis
    var y = d3.scaleLinear()
        .range([height, 0]);
    var yAxis = svg.append("g")
        .attr("class", "myYaxis")

    svg.attr("transform", "translate(80, 50)")


    // A function that create / update the plot for a given variable:
    function update(selectedVar) {

        // Parse the Data
        d3.csv("https://raw.githubusercontent.com/kinoshita197083/Data_visualisation_project/master/Flu_season_data_9years.csv", function (data) {

            // X axis
            x.domain(data.map(function (d) { return d.Season; }))
            xAxis.transition().duration(1000).call(d3.axisBottom(x));

            // Add Y axis
            y.domain([0, d3.max(data, function (d) { return +d[selectedVar] })]);
            yAxis.transition().duration(1000).call(d3.axisLeft(y));

            // variable u: map data to existing bars
            var u = svg.selectAll("rect")
                .data(data)



            //Create a tooltip
            var tooltip = d3.select("#my_dataviz")
                .append("div")
                .style("opacity", 0)
                .attr("class", "tooltip")
                .style("background-color", "white")
                .style("border", "solid")
                .style("border-width", "1px")
                .style("border-radius", "5px")
                .style("padding", "10px")
                .style("width", "120px")

            // Three function that change the tooltip when user hover / move / leave a cell
            var mouseover = function (d) {
                var value = d[selectedVar];

                tooltip
                    .html("Value: " + value)
                    .style("opacity", 1);
                d3
                    .select(this).style("fill", "black");
            }
            var mousemove = function (d) {
                tooltip
                    .style("left", d3.mouse(this)[0] + 400 + "px")
                    .style("top", d3.mouse(this)[1] + "px");

            }
            var mouseleave = function (d) {
                tooltip
                    .style("opacity", 0)
                d3
                    .select(this).style("fill", "#98AFC7");
            }

            // update bars
            u
                .enter()
                .append("rect")
                .merge(u)
                .transition()
                .duration(1000)
                .attr("x", function (d) { return x(d.Season); })
                .attr("y", function (d) { return y(d[selectedVar]); })
                .attr("width", x.bandwidth())
                .attr("height", function (d) { return height - y(d[selectedVar]); })
                .attr("fill", "#98AFC7")

            u
                .on("mouseover", mouseover)
                .on("mousemove", mousemove)
                .on("mouseleave", mouseleave)
        })

    }

    // Initialize plot
    update('Symptomatic')
</script>

</html>